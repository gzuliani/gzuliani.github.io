<html>
<head>
<title>Da ASCII a Unicode</title>
<link href="../css/main.css" rel="stylesheet" type="text/css"></link>
</head>
<body>
<p class="page-path"><a href="../index.html#unicode">risorse</a> | unicode</p>
<h1>Da ASCII a Unicode</h1>
<p>Il problema di rappresentare la scrittura nei calcolatori risale alle origini dell&rsquo;informatica. La soluzione pi&ugrave; frequentemente adottata &egrave; la definizione di una <em>codifica di carattere</em> che consiste nell&rsquo;associare ad ogni simbolo dell&rsquo;alfabeto in uso una particolare sequenza di bit. Questa associazione viene a volte erroneamente indicata col termine di <em>set di caratteri</em>, <em>mappa dei caratteri</em>, o <em>code page</em>.</p>
<p>Un tipico esempio di <em>codifica</em>, risalente al 1967 e ancora in uso in ambiente informatico, &egrave; lo standard <em>ASCII</em> &ndash; <em>American Standard Code for Information Interchange</em>.</p>
<h2 id="ascii">ASCII</h2>
<p>La componente base di una codifica &egrave; il <em>set di caratteri</em>, ovvero l&rsquo;insieme dei simboli che si intende considerare. Il set di caratteri della codifica ASCII comprende tutte le lettere dell&rsquo;alfabeto inglese, maiuscole e minuscole, le dieci cifre decimali, i simboli di interpunzione pi&ugrave; altri simboli grafici, oltre ad alcuni caratteri di controllo, come ad esempio l&rsquo;a-capo. L&rsquo;altro aspetto che caratterizza una codifica &egrave; l&rsquo;<em>unit&agrave; di codifica</em>, ovvero l&rsquo;unit&agrave; atomica utilizzata per costruire le rappresentazioni dei caratteri; nel caso dell&rsquo;ASCII consiste di un pacchetto di 7 bit. Poich&eacute; l&rsquo;ASCII attribuisce ad ogni carattere un&rsquo;unica unit&agrave; di codifica, e che ad ogni unit&agrave; atomica &egrave; associato un carattere distinto, l&rsquo;alfabeto ASCII &egrave; composto esattamente da 128 caratteri, con codici che vanno da <span class="code">0000000</span> (0) fino a <span class="code">1111111</span> (127).</p>
<pre>
    +---------------------------------------------------------------------+
    | B  \  6 -----------&gt;|  0  |  0  |  0  |  0  |  1  |  1  |  1  |  1  |
    |  I  \   5 ---------&gt;|  0  |  0  |  1  |  1  |  0  |  0  |  1  |  1  |
    |   T  \    4 -------&gt;|  0  |  1  |  0  |  1  |  0  |  1  |  0  |  1  |
    |    S                |-----------------------------------------------|
    |             COLUMN-&gt;|  0  |  1  |  2  |  3  |  4  |  5  |  6  |  7  |
    | 3 | 2 | 1 | 0 | ROW |     |     |     |     |     |     |     |     |
    +---------------------+-----------------------------------------------+
    | 0 | 0 | 0 | 0 |  0  | NUL | DLE | SP  |  0  |  @  |  P  |  `  |  p  |
    |---|---|---|---|-----|-----|-----|-----|-----|-----|-----|-----|-----|
    | 0 | 0 | 0 | 1 |  1  | SOH | DC1 |  !  |  1  |  A  |  Q  |  a  |  q  |
    |---|---|---|---|-----|-----|-----|-----|-----|-----|-----|-----|-----|
    | 0 | 0 | 1 | 0 |  2  | STX | DC2 |  "  |  2  |  B  |  R  |  b  |  r  |
    |---|---|---|---|-----|-----|-----|-----|-----|-----|-----|-----|-----|
    | 0 | 0 | 1 | 1 |  3  | ETX | DC3 |  #  |  3  |  C  |  S  |  c  |  s  |
    |---|---|---|---|-----|-----|-----|-----|-----|-----|-----|-----|-----|
    | 0 | 1 | 0 | 0 |  4  | EOT | DC4 |  $  |  4  |  D  |  T  |  d  |  t  |
    |---|---|---|---|-----|-----|-----|-----|-----|-----|-----|-----|-----|
    | 0 | 1 | 0 | 1 |  5  | ENQ | NAK |  %  |  5  |  E  |  U  |  e  |  u  |
    |---|---|---|---|-----|-----|-----|-----|-----|-----|-----|-----|-----|
    | 0 | 1 | 1 | 0 |  6  | ACK | SYN |  &amp;  |  6  |  F  |  V  |  f  |  v  |
    |---|---|---|---|-----|-----|-----|-----|-----|-----|-----|-----|-----|
    | 0 | 1 | 1 | 1 |  7  | BEL | ETB |  '  |  7  |  G  |  W  |  g  |  w  |
    |---|---|---|---|-----|-----|-----|-----|-----|-----|-----|-----|-----|
    | 1 | 0 | 0 | 0 |  8  | BS  | CAN |  (  |  8  |  H  |  X  |  h  |  x  |
    |---|---|---|---|-----|-----|-----|-----|-----|-----|-----|-----|-----|
    | 1 | 0 | 0 | 1 |  9  | HT  | EM  |  )  |  9  |  I  |  Y  |  i  |  y  |
    |---|---|---|---|-----|-----|-----|-----|-----|-----|-----|-----|-----|
    | 1 | 0 | 1 | 0 | 10  | LF  | SUB |  *  |  :  |  J  |  Z  |  j  |  z  |
    |---|---|---|---|-----|-----|-----|-----|-----|-----|-----|-----|-----|
    | 1 | 0 | 1 | 1 | 11  | VT  | ESC |  +  |   ; |  K  |  [  |  k  |  {  |
    |---|---|---|---|-----|-----|-----|-----|-----|-----|-----|-----|-----|
    | 1 | 1 | 0 | 0 | 12  | FF  | FS  |  ,  |  &lt;  |  L  |  \  |  l  |  |  |
    |---|---|---|---|-----|-----|-----|-----|-----|-----|-----|-----|-----|
    | 1 | 1 | 0 | 1 | 13  | CR  | GS  |  -  |  =  |  M  |  ]  |  m  |  }  |
    |---|---|---|---|-----|-----|-----|-----|-----|-----|-----|-----|-----|
    | 1 | 1 | 1 | 0 | 14  | SO  | RS  |  .  |  &gt;  |  N  |  ^  |  n  |  ~  |
    |---|---|---|---|-----|-----|-----|-----|-----|-----|-----|-----|-----|
    | 1 | 1 | 1 | 1 | 15  | SI  | US  |  /  |  ?  |  O  |  _  |  o  | DEL |
    +---------------------+-----------------------------------------------+
</pre>
<h2 id="dallascii-alle-code-page-oem">Dall&rsquo;ASCII alle <em>code page</em> (OEM)</h2>
<p>Poich&eacute; i computer dell&rsquo;epoca erano basati su architetture a 8 bit, la memorizzazione di un carattere ASCII in un byte lasciava un bit inutilizzato. Diversi costruttori e sviluppatori di software utilizzarono il bit extra nei modi più disparati, per esempio per indicare un'enfasi &mdash; corsivo, grassetto, sottolineatura, &hellip; &mdash;, per indicare il carattere finale di una parola, o per estendere la codifica, introducendo simboli non presenti nella codifica ASCII, come ad esempio le lettere accentate o quelle dell&rsquo;alfabeto greco o simboli grafici adatti a realizzare semplici sinottici.</p>
<p>La diffusione dei computer IBM-PC compatibili e la necessit&agrave; di localizzare i software spinse verso la standardizzazione delle estensioni proprietarie del codice ASCII, introducendo il concetto di set di caratteri <em>OEM</em> &mdash; <em>Original Equipment Manufacturer</em>. La costante di questo tipo di codifiche &egrave; l&rsquo;uso di unit&agrave; di codifica di 8 bit: le prime 128 posizioni coincidono con quelle del codice ASCII, mentre le successive 128, dal codice <span class="code">1000000</span> (128) al codice <span class="code">11111111</span> (255), sono di volta in volta utilizzate per simboli diversi.</p>
<p>Una particolare mappatura prende il nome di <em>code page</em>, e ogni pagina &egrave; indicata da un identificativo numerico. Per esempio, la pagina contenente le lettere accentate &egrave; la numero 850, mentre quella dedicata all&rsquo;alfabeto greco &egrave; la numero 737.</p>
<h2 id="code-page-oem-e-ansi">Code page OEM e ANSI</h2>
<p>Con l&rsquo;avvento di Windows, Microsoft introdusse delle nuove codifiche, sempre basate su code page. Per distinguerle da quelle OEM usate in ambiente DOS le denomin&ograve;, piuttosto infelicemente, <em>ANSI</em>: di fatto, non esiste alcuno standard ANSI a riguardo. Microsoft scelse quel nome perch&eacute; nel definire quelle codifiche si ispir&ograve; &ndash; piuttosto liberamente, in realt&agrave; &ndash; a una proposta di standard che per&ograve; non &egrave; mai stato preso in considerazione dal comitato ANSI, e che qualche anno pi&ugrave; tardi sarebbe divenuto l&rsquo;ISO-8859-1 (cfr. voce &ldquo;ANSI&rdquo; in<sup><a href="#ref-7">[7]</a></sup>). A titolo d'esempio, la code page ANSI Windows-1250 e lo standard ISO-8859-1 (noto anche come <em>Latin 1</em>) differiscono per ben 27 associazioni<sup><a href="#ref-9">[9]</a></sup>.</p>
<h2 id="ambiguita-delle-code-page">Ambiguit&agrave; delle <em>code page</em></h2>
<p>Poich&eacute; tutte le codifiche basate su code page estendono quella ASCII, un flusso di testo ASCII &egrave; perfettamente decodificabile utilizzando una qualunque codifica estesa; viceversa, un testo contenente caratteri specifici di una particolare code page OEM o Windows pu&ograve; essere decodificato correttamente solo tramite la medesima code page. Questo pu&ograve; rappresentare un problema, se il testo viene decodificato su un sistema che usa una code page diversa da quello che l&rsquo;ha codificato (cfr. <a href="#mojibake">mojibake</a>).</p>
<h2 id="codifiche-composte">Codifiche composte</h2>
<p>Una codifica basata su unit&agrave; a 8 bit che rappresenta ogni carattere con un&rsquo;unit&agrave; pu&ograve; rappresentare al pi&ugrave; 256 caratteri diversi. In alcuni ambiti questo limite &egrave; inaccettabile &ndash; le lingue asiatiche ne sono un esempio. Il problema viene normalmente risolto aumentando il numero di unit&agrave; di codifica utilizzate per rappresentare un singolo carattere. Nel caso si scelga di utilizzare due unit&agrave; di codifica per carattere, si parla di set di caratteri <em>DBCS</em> &ndash; <em>Double-byte character set</em>. In questo modo, il numero di caratteri rappresentabili sale a 65536. Alcune codifiche DBCS adottano particolari schemi di codifica mista, nelle quali alcuni caratteri vengono associati ad un&rsquo;unica unit&agrave; di codifica, altri a due: alla diminuzione del numero di simboli rappresentabili corrisponde per&ograve; la possibilit&agrave; di mantenere la compatibilit&agrave; con la codifica ASCII per i caratteri che la prevedono. Queste codifiche risultano di fatto incompatibili con quelle basate su code page, e ci&ograve; preclude la possibilit&agrave; di scambiare informazioni testuali tra due sistemi che adottano due schemi diversi; spesso, anche questa situazione &egrave; inaccettabile.</p>
<h2 id="unicode">Unicode</h2>
<h3 id="premessa-storica">Premessa storica</h3>
<p><em>Unicode</em> (originariamente <em>Unification Code</em>) nasce negli Stati Uniti nella seconda met&agrave; degli anni &lsquo;80 dallo sforzo congiunto di Xerox e IBM di definire un set di caratteri multi-lingua facilmente trattabile dai calcolatori, in particolare astraendo dalle code page e scegliendo un&rsquo;unit&agrave; di codifica a lunghezza fissa di 16 bit. I limiti di questa scelta si palesarono pochi anni pi&ugrave; tardi, quando il processo di standardizzazione delle lingue orientali produsse un catalogo di decine di migliaia ideogrammi &ndash; un alfabeto troppo ampio per poter essere interamente rappresentato con una codifica a 16 bit.</p>
<p>Contemporaneamente in Europa nasceva lo standard ISO/IEC 10646, che introduceva una codifica a 32 bit nota come <em>UCS</em> &ndash; <em>Universal (Coded) Character Set</em> che, prevedendo delle sequenze di <em>escape</em> per attivare delle modalit&agrave; di codifica differenti, rendeva praticamente infinito il numero di caratteri rappresentabili.</p>
<p>Agli inizi degli anni &lsquo;90 ebbe inizio un processo di unificazione delle due codifiche. Le attribuzioni dei codici della versione 6.1 di Unicode corrispondono perfettamente a quelle definite dallo standard ISO/IEC 10646:2012.</p>
<h3 id="code-point">Code point e <em>piani</em></h3>
<p>Ad ogni carattere Unicode assegna un <em>code point</em>, ovvero un valore numerico compreso tra <span class="code">0</span> e <span class="code">10FFFF</span> cui viene applicato il prefisso <span class="code">U+</span> (il code point della lettera A maiuscola &egrave; <span class="code">U+0041</span>). Non tutti i code point sono assegnati ad un carattere. La codifica &egrave; strutturata in <em>piani</em>, dove ogni piano &egrave; contiene 65536 caratteri. I piani definiti sono 16, e sono identificati dalle prime due cifre del codice esadecimale. I caratteri originali dello Unicode a 16 bit, i cui codici sono compresi tra <span class="code">0</span> e <span class="code">00FFFF</span> costituiscono il <em>piano zero</em> o <em>BMP</em> &ndash; <em>Basic Multilingual Plan</em>. I piani successivi sono detti <em>piani estesi</em> o <em>piani surrogati</em>. Se i caratteri del piano zero sono rappresentabili con 16 bit, quelli dei piani estesi necessitano di almeno 24 bit. Codificare caratteri con sequenze di lunghezza diversa pu&ograve; essere problematico, come gi&agrave; visto. D&rsquo;altra parte, anche utilizzare pi&ugrave; bit del necessario per rappresentare i caratteri ha i suoi svantaggi.</p>
<pre>
    +-------+---------------+-------------------------------------+-------+
    | Piano | Intervallo    | Descrizione                         | Abbr. |
    +-------+---------------+-------------------------------------+-------+
    |    00 | 000000-00FFFF | Basic Multilingual Plane            |  BMP  |
    |    01 | 010000-01FFFF | Supplementary Multilingual Plane    |  SMP  |
    |    02 | 020000-02FFFF | Supplementary Ideographic Plane     |  SIP  |
    |    03 | 030000-03FFFF | Tertiary Ideographic Plane          |  TIP  |
    | 04-13 | 040000-0DFFFF | non assegnati                       |   -   |
    |    14 | 0E0000-0EFFFF | Supplementary Special-purpose Plane |  SSP  |
    |    15 | 0F0000-0FFFFF | Supplementary Private Use Area-A    |   -   |
    |    16 | 100000-10FFFF | Supplementary Private Use Area-B    |   -   |
    +-------+---------------+-------------------------------------+-------+
</pre>
<h3 id="caratteri">Caratteri</h3>
<p>Il carattere in Unicode &egrave; un&rsquo;entit&agrave; astratta, indipendente dalla sua forma grafica (<em>glifo</em>); in questo senso, Unicode associa un code point alla <em>descrizione</em> di un carattere, senza entrare nel merito dell&rsquo;aspetto (corsivo, grassetto, con o senza le grazie, &hellip;). Ad esempio, il code point <span class="code">U+0041</span> &egrave; associato al carattere <em>LATIN CAPITAL LETTER A</em>, ed &egrave; solo per motivi di praticit&agrave; che nelle tabelle di codifica viene anche riportato un esempio di rappresentazione grafica del carattere.</p>
<h4>Equivalenza</h4>
<p>Per ragioni di compatibilit&agrave;, la codifica Unicode non &egrave; biunivoca: uno simbolo pu&ograve; essere identificato da differenti sequenze di caratteri; si parla in questo caso di caratteri <em>equivalenti</em>. Esistono due tipi di equivalenze:</p>
<dl>
<dt>equivalenza canonica</dt><dd>caratteri o sequenze di caratteri che rappresentano lo stesso simbolo astratto e che sono graficamente indistinguibili; un esempio sono i caratteri ottenibili per composizione:
<pre class="code">
    U+00E8 - LATIN SMALL LETTER E WITH GRAVE..........&#x00e8;

    U+0300 - COMBINING GRAVE ACCENT...................&#x0300;&nbsp;
    U+0065 - LATIN SMALL LETTER E.....................&#x0065;

    U+00E8 (&#x00e8;) &equiv; U+0300 U+0065 (&#x0300;&#x0065;)
</pre>
<p>Un caso di equivalenza canonica ternaria:</p>
<pre class="code">
    U+00C5 - LATIN CAPITAL LETTER A WITH RING ABOVE...&#x00c5;

    U+030A - COMBINING RING ABOVE.....................&#x030a;&nbsp;
    U+0041 - LATIN CAPITAL LETTER A...................&#x0041;

    U+212B - ANGSTROM SIGN............................&#x212b;

    U+00C5 (&#x00c5;) &equiv; U+030A U+0041 (&#x030a;&#x0041;) &equiv; U+212B (&#x212b;)
</pre>
</dd>
<dt>equivalenza di compatibilit&agrave;</dt><dd>caratteri o sequenze di caratteri che rappresentano lo stesso simbolo astratto ma che si distinguono per forma o altre caratteristiche; sono comprese le varianti grafiche, gli apici, i pedici, le legature, &hellip;:
<pre class="code">
    U+2460 CIRCLED DIGIT ONE..........................&#x2460;
    U+0031 DIGIT ONE..................................&#x0031;

    U+2460 (&#x2460;) &sim; U+0031 (&#x0031;)


    U+2083 - SUBSCRIPT THREE..........................&#x2083;
    U+0033 - DIGIT THREE..............................&#x0033;

    U+2083 (&#x2083;) &sim; U+0033 (&#x0033;)


    U+FB01 - LATIN SMALL LIGATURE FI..................&#xfb01;

    U+0066 - LATIN SMALL LETTER F.....................&#x0066;
    U+0069 - LATIN SMALL LETTER I.....................&#x0069;

    U+FB01 (&#xfb01;) &sim; U+0066 U+0069 (&#x0066;&#x0069;)
</pre></dd>
</dl>
<p>Poich&eacute; uno stesso carattere pu&ograve; assumere codifiche differenti, nasce il problema di stabilire, dati due testi Unicode, se questi sono uguali. A tal scopo sono state definite delle regole di normalizzazione delle rappresentazioni dei testi Unicode &ndash; <em>Unicode Normalization Forms<sup><a href="#ref-10">[10]</a></sup></em> &ndash; che si occupano di trasformare i testi originali in una forma primitiva comune, a partire dalla quale risulta pi&ugrave; semplice effettuare il confronto.</p>
<h3 id="separazione-tra-codifica-e-rappresentazione-binaria">Separazione tra codifica e rappresentazione binaria</h3>
<p>Se da una parte Unicode associa ad ogni carattere un codice univoco, dall&rsquo;altra offre la possibilit&agrave; di scegliere il formato di rappresentazione binaria dei codici (<em>UTF</em> &mdash; <em>Unicode/UCS Transformation Format</em>), variabile o fissa:</p>
<ul>
<li><p><em>UTF-8</em>: codifica multi-byte a lunghezza variabile con unit&agrave; di codifica a 8 bit, ASCII-compatibile; rappresenta ogni carattere con un minimo di 1 ad un massimo di 4 byte. E&rsquo; una codifica <em>stateless</em>, ovvero gli errori di codifica di un carattere non si propagano ai successivi;</p></li>
<li><p><em>UTF-16</em>: codifica multi-byte a lunghezza variabile con unit&agrave; di codifica a 16 bit; ogni carattere &egrave; rappresentato con una sequenza di 2 o 4 byte. Esiste nelle varianti <em>big endian</em> (<em>UTF-16BE</em>) e <em>little endian</em> (<em>UTF-16LE</em>);</p></li>
<li><p><em>UTF-32</em>: codifica multi-byte a lunghezz fissa con unit&agrave; di codifica a 32 bit; ogni carattere &egrave; rappresentato con una sequenza di 4 byte. Esiste nelle varianti <em>big endian</em> (<em>UTF-32BE</em>) e <em>little endian</em> (<em>UTF-32LE</em>).</p></li>
</ul>
<p>La tabella sottostante riporta il numero di byte necessario a rappresentare un code point nei vari formati:</p>
<pre>
    +---------------+----------------------------------------+-------+--------+--------+
    | Intervallo    | Caratteri contenuti                    | UTF-8 | UTF-16 | UTF-32 |
    +---------------+----------------------------------------+-------+--------+--------+
    | 000000-00007F | Basic Latin                            |   1   |    2   |    4   |
    | 000080-0007FF | Latin Extensions, Greek, Cyrillic, ... |   2   |    2   |    4   |
    | 000800-00FFFF | Thai, Hiragana, Katakana, ...          |   3   |    2   |    4   |
    | 010000-10FFFF | Cuneiform, Hieroglyphs, Private, ...   |   4   |    4   |    4   |
    +---------------+----------------------------------------+-------+--------+--------+
</pre>
<h4>Peculiarit&agrave; della codifica UTF-8</h4>
<p>La codifica UTF-8 distribuisce i bit di un code-point in una sequenza di byte secondo lo schema seguente:</p>
<pre>
    +---------------+------+-------------------------------------+
    | Intervallo    | Bits | Maschera                            |
    +---------------+------+-------------------------------------+
    | 000000-00007F |   7  | 0xxxxxxx                            |
    | 000080-0007FF |  11  | 110xxxxx 10xxxxxx                   |
    | 000800-00FFFF |  16  | 1110xxxx 10xxxxxx 10xxxxxx          |
    | 010000-10FFFF |  21  | 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx |
    +---------------+------+-------------------------------------+
</pre>
<p>La configurazione dei bit più significativi dei byte costituenti di una codifica UTF-8 assumono dunque un significato ben preciso:</p>
<pre>
    +----------+------------------------------------------------------+
    | Bits     | Significato                                          |
    +----------+------------------------------------------------------+
    | 0xxxxxxx | Byte iniziale di una sequenza di lunghezza 1 (ASCII) |
    | 10xxxxxx | Byte successivo al primo                             |
    | 110xxxxx | Byte iniziale di una sequenza di lunghezza 2         |
    | 1110xxxx | Byte iniziale di una sequenza di lunghezza 3         |
    | 11110xxx | Byte iniziale di una sequenza di lunghezza 4         |
    +----------+------------------------------------------------------+
</pre>
<p>Segue un esempio di codifica UTF-8:</p>
<pre>
    U+2135 - ALEF SYMBOL..............................&#x2135;

    2135 &rarr; 0010 0001 0011 0101 

           0010 0001 0011 0101 &rarr; 0010   000100   110101
                                  &darr;       &darr;        &darr;
                             1110xxxx 10xxxxxx 10xxxxxx
                                &darr;        &darr;        &darr;
                             11100010 10000100 10110101
                                &darr;        &darr;        &darr;
                                E2       84       B5

    U+2135 &rarr; E2 84 B5
</pre>
<h4>Peculiarit&agrave; della codifica UTF-16</h4>
<p>La codifica UTF-16 fa uso di alcuni speciali code-point del Basic Multilingual Plan, denominati <em>surrogati</em>, per indirizzare i caratteri al di fuori del BMP stesso. I surrogati sono 2048 code-point che non corrispondono a nessun carattere, e si suddividono in <em>surrogati alti</em>, i cui codici vanno da <span class="code">U+D800</span> fino a <span class="code">U+DBFF</span>, e <em>surrogati bassi</em>, da <span class="code">U+DC00</span> a <span class="code">U+DFFF</span>. I surrogati appaiono sempre in coppia, nell'ordine alto/basso.</p>
<p>La coppia di surrogati viene determinata sottraendo <span class="code">10000</span> dal code-point del carattere cos&igrave; da normalizzarlo nell'intervallo [<span class="code">0</span>, <span class="code">FFFFF</span>]; i venti bit rimanenti vengono equamente distribuiti nei dieci bit meno significativi del surrogato alto (<span class="code">D800</span>&div;<span class="code">DBFF</span> &harr; <span class="code">110110xxxxxxxxxx</span>) e quello basso (<span class="code">DC00</span>&div;<span class="code">DFFF</span> &harr; <span class="code">110111xxxxxxxxxx</span>):</p>
<pre>
    U+1D54A - MATHEMATICAL DOUBLE-STRUCK CAPITAL S....&#x1D54A;

    1D54A &rarr; 0001 1101 0101 0100 1010 -
            0001 0000 0000 0000 0000
            ========================
            0000 1101 0101 0100 1010
                 &darr;           &darr;
             0000110101  0101001010
                 &darr;           &darr;
       110110xxxxxxxxxx      &darr;
              &darr;              &darr;
       1101100000110101      &darr;
              &darr;              &darr;
             D835            &darr;
                   110111xxxxxxxxxx
                          &darr;
                   1101110101001010
                          &darr;
                         DD4A

    U+1D54A &rarr; D835 DD4A
</pre>
<h3 id="formato-utf-e-ucs">Formato UTF e UCS</h3>
<p>Anche l&rsquo;ISO/IEC 10646 specifica delle forme di codifica:</p>
<ul>
<li><p><em>UCS-2</em>: <em>&ldquo;Universal Character Set coded in 2 octets&rdquo;</em>, noto anche come <em>&ldquo;the two-octet BMP form&rdquo;</em>, rappresenta i soli caratteri del piano zero, ovvero quei caratteri rappresentabili con un&rsquo;unica unit&agrave; di 32 bit. In questo contesto, &egrave; compatibile con UTF-16. E&rsquo; stato dichiarato obsoleto nel 2011;</p></li>
<li><p><em>UCS-4</em>: <em>&ldquo;Universal Character Set coded in 4 octets&rdquo;</em>, equivale a UTF-32, ed &egrave; la forma canonica di rappresentazione dei caratteri.</p></li>
</ul>
<h3 id="il-bom">Il BOM</h3>
<p>Il <em>BOM</em> &mdash; <em>Byte order mark</em> &egrave; il carattere Unicode <span class="code">U+FEFF</span> quando utilizzato per specifare l&rsquo;<em>endianness</em> di una sequenza di caratteri Unicode. Tale carattere, denominato <em>&ldquo;zero width no-break space&rdquo;</em>, pu&ograve; occupare solo la prima posizione di una sequenza di caratteri Unicode e non ha altro effetto che quello di fornire un&rsquo;indicazione indiretta del tipo di ordinamento in uso &mdash; perdendo quindi il significato originale di &ldquo;zero width no-break space&rdquo;.</p>
<p><em>Nota</em>: il vincolo di poter apparire solo in prima posizione &egrave; stato introdotto nella versione 3.2 di Unicode. Non &egrave; quindi escluso che si possa trovare anche in posizioni intermedie, dove di nuovo assume il significato di &ldquo;zero width no-break space&rdquo;. In questo contesto andrebbe sostituito dal carattere <span class="code">U+2060</span> <em>&ldquo;word joiner&rdquo;</em>.</p>
<pre>
    +----------+------------+--------------+
    | Codifica | Endianness | BOM ammesso? |
    +----------+------------+--------------+
    | UTF-8    |      -     |      s&igrave;      |
    +----------+------------+--------------+
    | UTF-16   |      ?     |      s&igrave;      |
    | UTF-16BE |     big    |      no      |
    | UTF-16LE |    little  |      no      |
    +----------+------------+--------------+
    | UTF-32   |      ?     |      s&igrave;      |
    | UTF-32BE |     big    |      no      |
    | UTF-32LE |    little  |      no      |
    +----------+------------+--------------+
</pre>
<h4 id="il-bom-nellutf-8">Il BOM nell&rsquo;UTF-8</h4>
<p>Utilizzando unit&agrave; di codifica a 8 byte, in linea di principio la presenza del BOM &egrave; superflua; alcuni software tuttavia la potrebbero richiedere. Il BOM in UTF-8 &egrave; rappresentato dalla sequenza <span class="code">EF BB BF</span>.</p>
<h4 id="il-bom-nellutf-16">Il BOM nell&rsquo;UTF-16</h4>
<p>Se durante la decodifica di un flusso Unicode la prima coppia di byte incontrata &egrave; <span class="code">FE FF</span>, si pu&ograve; presupporre che si tratti del BOM di una sequenza big-endian. Se invece si trova <span class="code">FF FE</span>, essendo il code point <span class="code">U+FFFE</span> non valido, si pu&ograve; presupporre che si tratti del BOM di una sequenza little-endian. In genere, se un flusso binario inizia con la sequenza <span class="code">FF FE</span> o <span class="code">FE FF</span> si pu&ograve; ragionevolmente presupporre che si tratti di testo Unicode UTF-16.</p>
<h4 id="il-bom-nellutf-32">Il BOM nell&rsquo;UTF-32</h4>
<p>Valgono le stesse considerazioni fatte per l&rsquo;UTF-16.</p>
<a name="mojibake"></a>
<h3>Mojibake</h3>
<p>Il <em>mojibake</em> si verifica quando, a causa dell'adozione di una codifica errata, il testo non viene visualizzato correttamente. Ad esempio, la parola <em>caff&egrave;</em>, che corrisponde alla sequenza di code-point Unicode:</p>
<pre class="code">
    caff&egrave; &rarr; U+0063 U+0061 U+0066 U+0066 U+00E8
</pre>
<p>se codificata in UTF-8 origina la sequenza di byte:</p>
<pre class="code">
    caff&egrave; &rarr; 63 61 66 66 C3 A8
</pre>
<p>Questa stessa sequenza, se decodificata in ISO-8859-1, d&agrave; luogo alla &ldquo;parola&rdquo;:</p>
<pre class="code">
    63 61 66 66 C3 A8 &rarr; caff&#xc3;&#xa8;
</pre>
<p>Viceversa, la codifica ISO-8859-1 della parola originale corrisponde a:</p>
<pre class="code">
    caff&egrave; &rarr; 63 61 66 E8
</pre>
<p>che decodificata in UTF-8 produce:</p>
<pre class="code">
    63 61 66 E8 &rarr; caff&#xfffd;
</pre>
<p>Il carattere &#xfffd;, noto anche come <span class="code">REPLACEMENT CHARACTER</span>, &egrave; il simbolo convenzionalmente utilizzato da Unicode per segnalare la presenza di un code-point sconosciuto o non rappresentabile.</p>
<h3>Curiosit&agrave;</h3>
<p>In Python 3.x, la cui conformit&agrave; a Unicode &egrave; rimarchevole, accade questo (font permettendo):</p>
<pre class="code">
&gt;&gt;&gt; int(&quot;&#x09ea;&#x0b68;&quot;)
<strong>42</strong>
</pre>
<p>La risposta risulta meno sorprendente se si considera l'espressione seguente, equivalente alla prima:</p>
<pre class="code">
&gt;&gt;&gt; int(&quot;\u09ea\u0b68&quot;)
<strong>42</strong>
</pre>
<p>La consultazione delle tabelle Unicode risolve il mistero:</p>
<pre>
    U+09EA - BENGALI DIGIT FOUR.......................&#x09ea;
    U+0B68 - ORIYA DIGIT TWO..........................&#x0b68;
</pre>
<h2 id="riferimenti">Riferimenti</h2>
<ol>
<a name="ref-1"></a>
<li><p>Cimarosti, M. <em>&ldquo;Dodici anni di Unicode&rdquo;</em> &mdash; <a href="http://web.tiscali.it/marco.cimarosti/pro_graf.html">http://web.tiscali.it/marco.cimarosti/pro_graf.html</a>, visitato il 07/06/2013</p></li>
<a name="ref-2"></a>
<li><p>Kuhn, M. <em>&ldquo;UTF-8 and Unicode FAQ for Unix/Linux&rdquo;</em> &mdash; <a href="http://www.cl.cam.ac.uk/~mgk25/unicode.html">http://www.cl.cam.ac.uk/~mgk25/unicode.html</a>, visitato il 05/06/2013</p></li>
<a name="ref-3"></a>
<li><p>Searle, S. <em>&ldquo;A Brief History of Character Codes&rdquo;</em> &mdash; <a href="http://tronweb.super-nova.co.jp/characcodehist.html">http://tronweb.super-nova.co.jp/characcodehist.html</a></p></li>
<a name="ref-4"></a>
<li><p>Spolsky, J. <em>&ldquo;The Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses!)&rdquo;</em>, joelonsoftware.com &mdash; <a href="http://www.joelonsoftware.com/articles/Unicode.html">http://www.joelonsoftware.com/articles/Unicode.html</a>, visitato il 05/06/2013</p></li>
<a name="ref-5"></a>
<li><p><em>&ldquo;A Technical Introduction&rdquo;</em>, The Unicode Consortium &mdash; <a href="http://www.unicode.org/standard/principles.html">http://www.unicode.org/standard/principles.html</a>, visitato il 07/06/2013</p></li>
<a name="ref-6"></a>
<li><p><em>&ldquo;ASCII format for Network Interchange&rdquo;</em> &mdash; <a href="http://tools.ietf.org/rfc/rfc20.txt">http://tools.ietf.org/rfc/rfc20.txt</a>, visitato il 05/06/2013</p></li>
<a name="ref-7"></a>
<li><p><em>&ldquo;Global Development Center&rsquo;s Glossary</em>&ldquo;, microsoft.com &mdash; <a href="http://msdn.microsoft.com/en-us/goglobal/bb964658.aspx#a">http://msdn.microsoft.com/en-us/goglobal/bb964658.aspx#a</a>, visitato il 05/06/2013</p></li>
<a name="ref-8"></a>
<li><p><em>&ldquo;Microsoft OEM (DOS) Code Pages&rdquo;</em>, Character Sets And Code Pages At The Push Of A Button &mdash; <a href="http://msdn.microsoft.com/en-us/goglobal/bb964658.aspx#a">http://msdn.microsoft.com/en-us/goglobal/bb964658.aspx#a</a>, visitato il 05/06/2013</p></li>
<a name="ref-9"></a>
<li><p><em>&ldquo;Windows-1252&rdquo;</em>, wikipedia.com &mdash; <a href="https://en.wikipedia.org/wiki/Windows-1252">https://en.wikipedia.org/wiki/Windows-1252</a>, visitato il 05/06/2013</p></li>
<a name="ref-10"></a>
<li><p><em>&ldquo;Unicode Standard Annex #15 - UNICODE NORMALIZATION FORMS&rdquo;</em>, The Unicode Consortium &mdash; <a href="http://unicode.org/reports/tr15/">http://unicode.org/reports/tr15/</a>, visitato il 07/06/2013</p></li>
<a name="ref-11"></a>
<li><p><em>&ldquo;UTF-8 encoding table and Unicode characters&rdquo;</em>, utf8-chartable.de &mdash; <a href="http://www.utf8-chartable.de/unicode-utf8-table.pl">http://www.utf8-chartable.de/unicode-utf8-table.pl</a></p></li>
<a name="ref-12"></a>
<li><p><em>&ldquo;UTF-8 Sampler&rdquo;</em>, columbia.edu &mdash; <a href="http://www.columbia.edu/~fdc/utf8/">http://www.columbia.edu/~fdc/utf8/</a></p></li>
</ol>
<p class="modification-notice">Pagina modificata il 03/07/2013</p>
</body>
</html>
